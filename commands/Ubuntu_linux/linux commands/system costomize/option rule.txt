# 옵션처리 : getopt(3) // 라이브러리 함수

- 명령행 인자로 전달된 옵션을 편리하 게 처리하도록 getopt() 함수가 제공
- 리눅스에서는 표준에 따라 관련 헤더 파일이 다를 수 있음
- 리눅스는 POSIX를 따라 unistd.h를 선언

## 리눅스 명령 기본 규칙

getopt() 함수 관련 항목 (POSIX)
- [규칙 3] 옵션의 이름은 한 글자여야 한다
- [규칙 4] 모든 옵션의 앞에는 하이픈(-)이 있어야 한다
    - 예: ls -a ./
- [규칙 5] 인자가 없는 옵션은 하나의 - 다음에 묶여서 올 수 있다
    - 예: tar -xvzf test.tar.gz
- [규칙 6] 옵션의 첫 번째 인자는 공백이나 탭으로 띄고 입력해야 한다
    - 예: ls -l /tmp
- [규칙 7] 인자가 있어야 하는 옵션에서 인자를 생략할 수 없다
- [규칙 9] 명령행에서 모든 옵션은 명령의 인자보다 앞에 와야 한다
    - 예: ls /tmp -l 의 형태는 불가능
- [규칙 10] 옵션의 끝을 나타내기 위해 --을 사용할 수 있다
----------------------------------------------
[규칙 10]
# 오류 발생: "-file"이 옵션으로 인식됨
rm -file
# 옵션이 끝났음을 명시하여 정상적으로 파일 삭제
rm -- -file
----------------------------------------------

### 롱 옵션:
명령어 –a --긴 옵션1 –c 옵션 인자 –f 옵션 인자 --긴 옵션2=옵션 인자 --긴 옵션3 옵션 인자 파일명

- [규칙 15] 긴 옵션은 -- 다음에 와야 한다. 옵션명으로는 문자, 숫자, -만 사용할 수 있으며, -으로 연결한 1~3개 단어를 사용할 수도 있다
```
ls -l
ls --format=long
```
- [규칙 16] ‘--이름=인자’ 형태는 긴 옵션 사용에서 옵션의 인자를 상세하게 지정할 때 사용해야 한다
    -(예에서 긴 옵션2의 경우). ‘--이름 인자’ 형태도 가능하다 (예에서 긴 옵션3의 경우)
- [규칙 17] 모든 명령은 긴 옵션 --version(-V도 지원)과 --help(-?도 지원)를 표준으로 지원해야 한다
```
gcc --help
```
- [규칙 18] 모든 짧은 옵션에 대응하는 긴 옵션이 있어야 하고, 긴 옵션에도 대응하는 짧은 옵션이 있어야 한다
```
~$ ls -a
~$ ls --all
```

## 적용 예시
----------------------------------------------
POSIX.2, XPG4, SUS, SUSv2, SUSv3
#include <unistd.h>
int getopt(int argc, char * const argv[], const char *optstring);
extern char *optarg;
extern int optind, opterr, optopt;
----------------------------------------------

| 형식          | 명령어 예시                              | 설명                                      |
|---------------|------------------------------------------|-------------------------------------------|
| "a"           | `./program -a`                           | -a 옵션 사용 가능 (값 필요 없음)          |
| "abc"         | `./program -a -b -c`                     | -a, -b, -c 옵션 사용 가능                |
| "a:"          | `./program -a value`                     | -a 옵션 뒤에 필수 인자 필요              |
| "ab:c:"       | `./program -b -c value`                  | -b는 필수 인자, -c는 필수 인자 필요     |
| "a::"         | `./program -a` 또는 `./program -a value` | -a 옵션 뒤에 "선택적 인자" 가능 (GNU 전용)|

